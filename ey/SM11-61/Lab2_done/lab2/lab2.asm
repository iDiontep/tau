.include "m16def.inc"

.equ LED_PORT = PORTB
.equ LED_DDR = DDRB
.equ LED_MASK = 0b01110000

.equ BUTTON_PORT = PIND
.equ BUTTON_DDR = DDRD
.equ BUTTON_PIN = PD3
.equ BUTTON_PIN2 = PD4

.org 0x0000
rjmp main
;????? ??? ?? ???????? ?????
.org 0x001c
main:
ldi r16, 0xFF ; ????????????? ???? B ?? ?????
out LED_DDR, r16
ldi r16, (1 << BUTTON_PIN) | (1 <<BUTTON_PIN2) ; ????????????? ???? ?????? ??? ?????
out BUTTON_DDR, r16
ldi r16, (1 << BUTTON_PIN) | (1 << BUTTON_PIN2) ; ?????????? ????????????? ????????? ? ????? ??????
out BUTTON_PORT, r16
; ??? ? ??? ?????????? ???? ???????????
loop:
sbis BUTTON_PORT, BUTTON_PIN ; ?????? ?? ?????? PD3?
rjmp seq1 ; ???? ??, ????????? ?? ????????? seq1
sbis BUTTON_PORT, BUTTON_PIN2 ; ?????? ?? ?????? PD4?
rjmp seq2 ; ???? ??, ????????? ?? ????????? seq2
rjmp loop ; ???? ???, ?????????? ????
; ??????? 7-5-6-4
seq1:
ldi r16, LED_MASK ; ????????? ????? ???????????
out LED_PORT, r16 ; ???????? ?????????? 7 ? 5
ldi r17, 0x00 ; ????????? ??????? ??????? ??? ????????
ldi r18, 0xFF ; ????????? ???????????? ???????? ??? ????????
loop1:
dec r18 ; ????????? ???????
brne loop1 ; ???? ??????? ?? ????? ????, ?????????? ???? ????????
cbi LED_PORT, 7 ; ????????? ????????? 7
sbi LED_PORT, 6 ; ???????? ????????? 6
ldi r18, 0xFF ; ????????? ???????????? ???????? ??? ????????
loop2:
dec r18 ; ????????? ???????
brne loop2 ; ???? ??????? ?? ????? ????, ?????????? ???? ????????
cbi LED_PORT, 5 ; ????????? ????????? 5
sbi LED_PORT, 4 ; ???????? ????????? 4
ldi r18, 0xFF ; ????????? ???????????? ???????? ??? ????????
loop3:
dec r18 ; ????????? ???????
brne loop3 ; ???? ??????? ?? ????? ????, ?????????? ???? ????????
cbi LED_PORT, 6 ; ????????? ????????? 6
sbi LED_PORT, 7 ; ???????? ????????? 7
rjmp loop ; ????????? ? ????????? ?????
; ??????? 4-6-5-7
seq2:
ldi r16, LED_MASK ; ????????? ????? ???????????
out LED_PORT, r16 ; ???????? ?????????? 4 ? 6
ldi r17, 0x00 ; ????????? ??????? ??????? ??? ????????
ldi r18, 0xFF ; ????????? ???????????? ???????? ??? ????????
loop4:
dec r18 ; ????????? ???????
brne loop4 ; ???? ??????? ?? ????? ????, ?????????? ???? ????????
cbi LED_PORT, 4 ; ????????? ????????? 4
sbi LED_PORT, 5 ; ???????? ????????? 5
ldi r18, 0xFF ; ????????? ???????????? ???????? ??? ????????
loop5:
dec r18 ; ????????? ???????
brne loop5 ; ???? ??????? ?? ????? ????, ?????????? ???? ????????
cbi LED_PORT, 6 ; ????????? ????????? 6
sbi LED_PORT, 4 ; ???????? ????????? 4
ldi r18, 0xFF ; ????????? ???????????? ???????? ??? ????????
loop6:
dec r18 ; ????????? ???????
brne loop6 ; ???? ??????? ?? ????? ????, ?????????? ???? ????????
cbi LED_PORT, 5 ; ????????? ????????? 5
sbi LED_PORT, 7 ; ???????? ????????? 7
rjmp loop ; ????????? ? ????????? ?????
